<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <title>Models browser</title>
        <base href="/">

        <style>
            body {
                color: #000;
                font-family:Monospace;
                font-size:13px;
                text-align:center;
                font-weight: bold;
                background-color: #fff;
                margin: 0;
                overflow: hidden;
            }

            #info {
                position: absolute;
                top: 0px; width: 100%;
                padding: 5px;
                background-color: rgba(189, 124, 124, .75);
            }

            p {
                margin: 0 0 5px;
            }

            ul, li {
                margin: 0;
                padding: 0;
            }

            ul {
                margin-left: 10px;
            }

            li {
                float: left;
                list-style: none;
            }

            a {
                color: #fff;
                display: block;
                margin: 0 10px 0 0;
                padding: 2px 10px 5px;
                background-color: #800020;
                text-decoration: none;
                border-radius: 10px;
            }
        </style>

        <script src="/json-models/js/three.min.js"></script>
        <script src="/json-models/js/controls/OrbitControls.js"></script>
    </head>
    <body>
        <div id="container"></div>

        <div id="info">
            <ul id="list"></ul>
        </div>

        <script>
            var models = [
                { text: 'monkey', json: '/json-models/monkey/monkey.json' },
                { text: 'test-cube', json: '/json-models/test-cube/test-cube.json' },
                { text: 'human', json: '/json-models/human/human.json' },
                { text: 'two-columns', json: '/json-models/two-columns/two-columns.json' }
            ];
            var currentModel;
            var camera;
            var controls;
            var scene;
            var renderer;

            init();
            controls.update();
            render();

            models.map(function (model) {
                var list = document.getElementById('list');
                var li = document.createElement('li');
                var a = document.createElement('a');

                a.href = model.json;
                a.text = model.text;
                a.addEventListener('click', function (event) {
                    event.preventDefault();

                    loadModel({
                        url: event.currentTarget.href
                    });
                });

                li.appendChild(a);
                list.appendChild(li);
            });

            function removeCurrentModel() {
                if (!currentModel || !currentModel.id) {
                    return;
                }

                var toRemove = scene.getObjectById(currentModel.id);

                if (!toRemove) {
                    return;
                }

                scene.remove(toRemove);
                render();
            }

            function loadModel (input) {
                var loader = new THREE.JSONLoader();

                removeCurrentModel();

                loader.load(input.url, function (geometry, material) {
                    var model;

                    material = new THREE.MeshLambertMaterial({color: 0xffffcc});
                    model = new THREE.Mesh(geometry, material);

                    model.position.set(0, 0, 0);

                    currentModel = model;

                    scene.add(currentModel);
                    render();
                });
            }

            function random (minPositive, minNegative, maxSeed) {
                var value = (Math.random() - 0.5) * maxSeed;

                if (value > minPositive) {
                    return minPositive;
                }

                if (value < minNegative) {
                    return minNegative;
                }

                return value;
            }

            function init() {
                scene = new THREE.Scene();
                scene.fog = new THREE.FogExp2( 0x000000, 0.002 );
                renderer = new THREE.WebGLRenderer();
                renderer.setClearColor( scene.fog.color );
                renderer.setPixelRatio( window.devicePixelRatio );
                renderer.setSize( window.innerWidth, window.innerHeight );

                var container = document.getElementById( 'container' );

                container.appendChild( renderer.domElement );

                camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 1000 );
                camera.position.z = 10;
                controls = new THREE.OrbitControls( camera, renderer.domElement );

                // add this change event listener only if there is no animation loop (requestAnimationFrame)
                controls.addEventListener('change', render);

                controls.enableDamping = true;
                controls.dampingFactor = 0.25;
                controls.enableZoom = true;

                // Load a model by default.
                loadModel({ url: models[0].json });

                // world
                var geometry = new THREE.BoxGeometry(5, 5, 5);
                var material =  new THREE.MeshPhongMaterial( { color:0x990000 } );
                for ( var i = 0; i < 666; i ++ ) {
                    var mesh = new THREE.Mesh( geometry, material );
                    mesh.position.x = random(20, -20, 1000);
                    mesh.position.y = random(20, -20, 1000);
                    mesh.position.z = random(20, -20, 1000);
                    mesh.updateMatrix();
                    mesh.matrixAutoUpdate = false;
                    scene.add( mesh );
                }

                // 2 points lighting and one overall ambient light.
                light = new THREE.DirectionalLight( 0xffcccc );
                light.position.set( 1, 1, 1 );
                scene.add( light );
                light = new THREE.DirectionalLight( 0x800020 );
                light.position.set( -1, -1, -1 );
                scene.add( light );
                light = new THREE.AmbientLight( 0x100000 );
                scene.add( light );

                // When window is resize, recalculate the camera aspect.
                window.addEventListener( 'resize', onWindowResize, false );
            }

            function onWindowResize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize( window.innerWidth, window.innerHeight );
                render();
            }

            function render() {
                renderer.render( scene, camera );
            }
        </script>
    </body>
</html>



